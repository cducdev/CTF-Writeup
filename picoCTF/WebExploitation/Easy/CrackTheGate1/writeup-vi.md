# Crack the Gate 1

**Tác giả:** 4uckd3v  
**Ngày:** 2026-02-06
**CTF / Platform:** picoCTF
**Thể loại:** Web
**Độ khó:** Dễ

---

## Tóm tắt ngắn gọn

Tìm cách vượt qua bước đăng nhập của trang web bằng một cánh cổng bí mật mà developer bỏ quên.

---

## Thông tin challenge

- **Mô tả chính thức:**

> We’re in the middle of an investigation. One of our persons of interest, ctf player, is believed to be hiding sensitive data inside a restricted web portal. We’ve uncovered the email address he uses to log in: ctf-player@picoctf.org. Unfortunately, we don’t know the password, and the usual guessing techniques haven’t worked. But something feels off... it’s almost like the developer left a secret way in. Can you figure it out?

---

## Phân tích

Truy cập website được cung cấp, ta thấy trang login với 2 input field là `Email` và `Password`
![Trang đăng nhập](./img/analysis.login-ui.png)

Thử login với email ctf-player@picoctf.org và các password phổ biến nhưng đều không thành công.

![Invalid credentials](./img/analysis.invalid-credentials.png)

Bật source code ra thấy 2 dòng comment đáng ngờ.

![Analysis source code](./img/analysis.source-code.png)

Comment bất thường kèm `Remove before pushing to production!` cho thấy developer quên xoá trước khi deploy. Comment đầu tiên có vẻ là một loại encoding, giống **Caesar Cipher**.

Sau khi thử các shift value khác nhau, decode được:
`NOTE: Jack - temporary byspass: use header "X-Dev-Access: yes"`

Gửi request với header `X-Dev-Access: yes` bypass được authentication và lấy được flag.

---

## Khai thác

Gửi POST request tới endpoint `/login` với header `X-Dev-Access: yes` để bypass authentication. Password value không quan trọng vì header này cho phép bypass.

**Sử dụng curl:**

```bash
curl -X POST [TARGET_URL] \
  -H "X-Dev-Access: yes" \
  -H "Content-Type: application/json" \
  -d '{"email":"ctf-player@picoctf.org","password":"11"}'
```

---

## Chứng minh

![Flag obtained](./img/proof.flag.png)

---

## Giải thích lỗ hổng

Developer để lại comments chứa credentials và hints header đặc biệt trong source code trước khi deploy.

- **Root cause:** Credentials được hardcode và debug hints bị để lại trong production code
- **Cách hoạt động:** Developer encode ghi chú chứa header đặc biệt (`X-Dev-Access: yes`) để bypass authentication
- **Tại sao khai thác được:** Source code truy cập được từ client, tiết lộ bypass mechanism

---

## Biện pháp giảm thiểu

- Xoá tất cả debug comments, credentials, và hints trước khi deploy
- Dùng environment variables cho sensitive config thay vì hardcoding
- Implement authentication checks đúng cách, không thể bypass bằng headers
- Sử dụng code review process phát hiện secrets và debug code
- Bật SAST (Static Application Security Testing) tools phát hiện hardcoded secrets

---

## Bài học rút ra

- Luôn sanitize code trước khi push production
- Không để lại debug credentials hoặc authentication bypass mechanisms trong deployed code
- Source code inspection là kỹ thuật reconnaissance quý giá trong web security
- Encoding đơn giản (như Caesar Cipher) không cung cấp bảo mật thực sự

---

## Tài liệu tham khảo

- Caesar Cipher: https://en.wikipedia.org/wiki/Caesar_cipher
